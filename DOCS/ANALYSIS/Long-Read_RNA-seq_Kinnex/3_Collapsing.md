
# Transcript Collapsing

In this step, the pipeline merges redundant consensus transcripts that align to the same genomic loci. Transcripts with identical exon–intron structures are collapsed into a single representative transcript model. The output includes unique isoforms in GFF format, a FASTA sequence file, and several supporting metric files.

Both the aligned consensus reads and the original Full Length Non Chimeric (FLNC) reads are used to determine transcript structure and quantify read support.

## Collapsing Consensus Transcripts

##### Collapse redundant transcripts into unique isoforms

```text
isoseq collapse --do-not-collapse-extra-5exons aligned_transcripts.bam flnc.bam collapsed_isoforms.gff
```

Arguments:

- *flnc.bam*: original FLNC reads used to assess transcript support by counting the number of reads mapped to each isoform.
- *-\-do-not-collapse-extra-5exons*: prevents collapsing of isoforms that differ only in extra 5’ exons. This preserves transcription start site (TSS) diversity and is recommended for bulk Iso-Seq applications.

*Note: In addition to the GFF, the output includes a TXT file with read-to-isoform mappings, a TXT file listing transcript support statistics (FLNC counts), and a JSON file with detailed metrics. These files are required for downstream annotation and quality control.*

## Implementation with IsoSeq

The pipeline uses [IsoSeq](https://github.com/PacificBiosciences/IsoSeq) version 4.2.0.

## Source Code

All the relevant code can be accessed in the GitHub repository:

  - [isoseq_collapse.sh](https://github.com/smaht-dac/rnaseq-pipelines/blob/main/dockerfiles/isoseq/isoseq_collapse.sh) [collapse]

---

<!-- This section relies on the html links generated by GitHub Pages 
and will not render correctly in Markdown -->
<div style="text-align: right">
    <a href="/pipelines-docs/"> Home </a> -
    <a href="0_Overview.html"> Overview </a> -
    <a href="1_Clustering.html"> Clustering </a> -
    <a href="2_Alignment.html"> Alignment </a> -
    <a> <b> Collapsing </b> </a> -
    <a href="4_Classification_and_Filtering.html"> Classification and Filtering </a> -
    <a href="5_Annotation.html"> Annotation </a>
</div>